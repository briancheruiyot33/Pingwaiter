let o=localStorage.getItem("audioEnabled")==="true";function r(){const e=new Audio("/assets/audio/service-bell.mp3");e.volume=.2,e.play().catch(i=>console.error("Sound playback failed:",i))}function d(){if(typeof window.Echo>"u"){setTimeout(d,100);return}const e=document.querySelector('meta[name="restaurant-id"]');if(!e)return;const i=e.getAttribute("content");window.Echo.private("restaurant."+i).listen(".ping.waiter",n=>{o&&r()}).listen(".pending.order",n=>{const t=`Order from table ${n.order.table_code} is pending approval.`;if(o){const a=new SpeechSynthesisUtterance(t);speechSynthesis.speak(a)}c(t,new Date().toLocaleTimeString())}),window.Echo.connector.pusher.connection.bind("connected",()=>{console.log("%c✅ Pusher connected!","color: green; font-weight: bold;")}),window.Echo.connector.pusher.connection.bind("error",n=>{console.error("❌ Pusher connection error:",n)})}function c(e,i){const n=document.getElementById("notificationList");if(!n)return;const s=`
        <div class="flex px-4 py-3 hover:bg-gray-100 dark:hover:bg-dark-icon">
            <div class="flex-shrink-0">
                <img class="size-10 rounded-50" src="/assets/images/user/profile-img.png" alt="user">
            </div>
            <div class="w-full ps-3">
                <div class="text-gray-500 dark:text-gray-400 text-sm mb-1.5">${e}</div>
                <div class="text-xs text-blue-600 dark:text-blue-500">${i}</div>
            </div>
        </div>`;n.insertAdjacentHTML("afterbegin",s);const t=document.querySelector('[data-popover-target="dropdownNotification"] span');t&&(t.innerText=parseInt(t.innerText||0)+1)}window.toggleGlobalSound=function(){o=!o,localStorage.setItem("audioEnabled",o);const e=document.getElementById("soundToggle");e&&(o?(e.innerHTML='<i class="bi bi-volume-up-fill"></i> Sound On',e.classList.remove("sound-off"),e.classList.add("sound-on")):(e.innerHTML='<i class="bi bi-volume-mute-fill"></i> Sound Off',e.classList.remove("sound-on"),e.classList.add("sound-off"))),Swal.fire({icon:o?"success":"info",title:o?"Sound Enabled":"Sound Muted",text:o?"Notifications will now play sound.":"Notifications will be silent.",toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("soundToggle");e&&(o?(e.innerHTML='<i class="bi bi-volume-up-fill"></i> Sound On',e.classList.remove("sound-off"),e.classList.add("sound-on")):(e.innerHTML='<i class="bi bi-volume-mute-fill"></i> Sound Off',e.classList.remove("sound-on"),e.classList.add("sound-off")))});d();
